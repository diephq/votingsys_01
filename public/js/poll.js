function nextTab(e){$(e).next().find('a[data-toggle="tab"]').click()}function prevTab(e){$(e).prev().find('a[data-toggle="tab"]').click()}function autoScrollToElement(e){$("html, body").animate({scrollTop:$("#"+e).offset().top+100},2e3)}function confirmDelete(e){return confirm(e)}function showAndHidePassword(){"password"==$("#password").attr("type")?($("#password").attr("type","text"),$(".show-password").html('<i class="fa fa-eye-slash" aria-hidden="true"></i>')):($("#password").attr("type","password"),$(".show-password").html('<i class="fa fa-eye" aria-hidden="true"></i>'))}function showModelImage(e){$("#imageOfOptionPreview").attr("src",e),$("#modalImageOption").modal("show")}function showResultPoll(){$(".result-poll").toggle(),"show"==$(".btn-show-result-poll").attr("id")?($(".li-show-result-poll").removeClass("fa-eye").addClass("fa-eye-slash"),$(".btn-show-result-poll").attr("id","hide")):($(".li-show-result-poll").removeClass("fa-eye-slash").addClass("fa-eye"),$(".btn-show-result-poll").attr("id","show"))}function hideLabelMessage(e){setTimeout(function(){$(e).html("")},2e3)}function voted(e,a){"horizontal"==a?($("#horizontal-"+e).prop("checked",!$("#horizontal-"+e).prop("checked")),$("#vertical-"+e).prop("checked",$("#horizontal-"+e).prop("checked"))):($("#vertical-"+e).prop("checked",!$("#vertical-"+e).prop("checked")),$("#horizontal-"+e).prop("checked",$("#vertical-"+e).prop("checked")))}function createOption(e,a,t){if(a="undefined"==typeof a?pollData.config.length.option_inc:a,null!=t){var l=t.optionText;jQuery.each(l,function(a,t){var l="";l=e.replace(/idOption/g,a),$(".poll-option").append(l),setObjectDatePicker(),$("#optionText-"+a).val(t)})}else for(var i=0;i<a;i++){var o=rand(),r="";r=e.replace(/idOption/g,o),$(".poll-option").append(r),setObjectDatePicker()}}function showOptionImage(e){addAutoOption(e),$('input[name = "optionImage['+e+']"]').click()}function addAutoOption(e){if($("#optionText-"+e).removeClass("error-input"),$("#"+e).is(":last-child")){var a=pollData.view.option,t=pollData.config.length.option_inc;createOption(a,t)}}function readURL(e,a){if(ValidateSingleInput(e.files[0].name)){if(e.files&&e.files[0]){var t=new FileReader;t.onload=function(e){$("#"+a).show().attr("src",e.target.result),checkImageSame()},t.readAsDataURL(e.files[0])}}else $("#"+a).hide()}function removeOpion(e,a){if("undefined"!=typeof pollData&&"undefined"!=typeof a&&"edit"==a)confirmDelete(pollData.message.confirm_delete_option)&&$("#"+e).remove();else{$("#"+e).remove();var t=$('input[name^="optionText"]');if(0==t.length){$(".error_option").addClass("has-error").html('<span id="title-error" class="help-block">'+pollData.message.option_minimum+"</span>");var l=pollData.view.option;createOption(l)}}}function settingAdvance(e){switch($("#limit").removeClass("has-error"),$(".error_limit").removeClass("has-error").html(""),$("#link").removeClass("has-error"),$(".error_link").removeClass("has-error").html(""),$("#password").removeClass("has-error"),$(".error_password").removeClass("has-error").html(""),e){case pollData.config.setting.required:$("#setting-required").slideToggle();break;case pollData.config.setting.custom_link:$("#setting-link").slideToggle();break;case pollData.config.setting.set_limit:$("#setting-limit").slideToggle();break;case pollData.config.setting.set_password:$("#setting-password").slideToggle()}}function ValidateSingleInput(e){var a=e;if(a.length>0){for(var t=!1,l=0;l<_validFileExtensions.length;l++){var i=_validFileExtensions[l];if(a.substr(a.length-i.length,i.length).toLowerCase()==i.toLowerCase()){t=!0;break}}if(!t)return $(".error_option").addClass("has-error").html('<span id="title-error" class="help-block">'+pollData.message.image+"</span>"),!1}return!0}function validateOption(){var e=$('input[name^="optionText"]'),a=$('input[name^="optionImage"]'),t=!0,l=!1;return $("#validateOption").html(""),"undefined"!=typeof dataAction&&"duplicate"==dataAction&&""!==$(".old-option").text().trim()||(0==e.length&&0==a.length?($(".error_option").addClass("has-error").html('<span id="title-error" class="help-block">'+pollData.message.option_empty+"</span>"),!1):(e.each(function(){""!=$(this).val()&&(l=!0)}),l?(e.each(function(e){var l=$(this).attr("id"),i=l.match(/optionText-(.*)/)[1];""==$(this).val()&&a.each(function(e){$(this).attr("name").indexOf(i)>-1&&""!=$(this).val()&&($("#"+l).addClass("error-input"),$(".error_option").addClass("has-error").html('<span id="title-error" class="help-block">'+pollData.message.option_required+"</span>"),t=!1)})}),t):($(".error_option").addClass("has-error").html('<span id="title-error" class="help-block">'+pollData.message.option_required+"</span>"),!1)))}function validateParticipant(){var e=$("#member").val();if(""==e)return $(".error_participant").removeClass("has-error"),!0;e=e.split(",");for(var a=0;a<e.length;a++)if(!validateEmail(e[a]))return $(".error_participant").addClass("has-error").html('<span id="title-error" class="help-block">'+pollData.message.email+"</span>"),!1;return $(".error_participant").removeClass("has-error"),!0}function validateEmail(e){var a=/^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/;return!!$.trim(e).match(a)}function validateLink(e){return $.ajax({url:$(".hide").data("routeLink"),type:"post",async:!1,dataType:"json",data:{token:e,_token:$(".hide").data("token")},success:function(e){e.success?$(".message-send-mail").html("<div class='alert alert-success'>"+pollData.message.send_email_success+"</div>"):$(".message-send-mail").html("<div class='alert alert-danger'>"+pollData.message.send_email_fail+"</div>")}})}function updatePollInfo(){var e=$("#form_update_poll_info").valid();return e?($(".loader").show(),!0):($validator.focusInvalid(),!1)}function updatePollSetting(){var e=!0,a=!0,t=!0;return $('input[name^="setting"]:checked').each(function(){switch($(this).val()){case pollData.config.setting.custom_link:e=checkLink($(".hide").data("linkPoll"));break;case pollData.config.setting.set_limit:a=checkLimit();break;case pollData.config.setting.set_password:t=checkPassword()}}),!!(e&&a&&t)&&($(".loader").show(),!0)}function checkLink(e){var a=$("#link").val();return""==a?($("#link").addClass("has-error"),$(".error_link").addClass("has-error").html('<span id="title-error" class="help-block">'+pollData.message.required+"</span>"),!1):"undefined"!=typeof e&&e!=pollData.config.link+a&&validateLink($("#link").val()).responseJSON.success?($("#link").addClass("has-error"),$(".error_link").addClass("has-error").html('<span id="title-error" class="help-block">'+pollData.message.link_exists+"</span>"),!1):validateLink($("#link").val()).responseJSON.success?($("#link").addClass("has-error"),$(".error_link").addClass("has-error").html('<span id="title-error" class="help-block">'+pollData.message.link_exists+"</span>"),!1):($("#link").removeClass("has-error"),$(".error_link").removeClass("has-error").html('<span id="title-success" class="help-block">'+pollData.message.link_valid+"</span>"),!0)}function checkLimit(){var e=$("#limit").val();return""==e?($("#limit").addClass("has-error"),$(".error_limit").addClass("has-error").html('<span id="title-error" class="help-block">'+pollData.message.required+"</span>"),!1):Number.isInteger(e)||e>0?"edit"==dataAction&&e<=$(".hide").data("totalVote")?($("#limit").addClass("has-error"),$(".error_limit").addClass("has-error").html('<span id="title-error" class="help-block">'+pollData.message.number_edit+$(".hide").data("totalVote")+"</span>"),!1):($("#limit").removeClass("has-error"),$(".error_limit").removeClass("has-error").html(""),!0):($("#limit").addClass("has-error"),$(".error_limit").addClass("has-error").html('<span id="title-error" class="help-block">'+pollData.message.number+"</span>"),!1)}function checkPassword(){var e=$("#password").val();return""==e?($("#password").addClass("has-error"),$(".error_password").addClass("has-error").html('<span id="title-error" class="help-block">'+pollData.message.required+"</span>"),!1):($("#password").removeClass("has-error"),$(".error_password").removeClass("has-error"),!0)}function checkValidFormWinzard(e,a,t){var l=e.bootstrapWizard("currentIndex"),i=a.valid();if(!i)return t.focusInvalid(),!1;if(1==l)return validateOption()&&!checkOptionSame();if(2==l){var o=!0,r=0;return $('input[name^="setting"]:checked').each(function(){switch(r=parseInt($(this).val())){case pollData.config.setting.custom_link:o=checkLink();break;case pollData.config.setting.set_limit:o=checkLimit();break;case pollData.config.setting.set_password:o=checkPassword()}}),o}}function changeLinkAdmin(){var e=$(".hide").data("tokenAdmin");e!=$("#link_admin").val()?$("#label_link_admin").removeAttr("href"):$("#label_link_admin").attr("href",$(".token-admin").val()),(pollData.config.link+$("#link_admin").val()).length>60?$("#label_link_admin").html((pollData.config.link+$("#link_admin").val()).substring(0,60)+"..."):$("#label_link_admin").html(pollData.config.link+$("#link_admin").val()),""==$("#link_admin").val()?($("#link_admin").addClass("has-error"),$(".error_link_admin").addClass("has-error"),$(".error_link_admin").html('<span id="title-error" class="help-block">'+pollData.message.required+"</span>")):validateLink($("#link_admin").val()).responseJSON.success?($("#link_admin").addClass("has-error"),$(".error_link_admin").addClass("has-error"),$(".error_link_admin").html('<span id="title-error" class="help-block">'+pollData.message.link_exists+"</span>"),hideLabelMessage(".error_link_admin")):($("#link_admin").removeClass("has-error"),$(".error_link_admin").removeClass("has-error"),$(".error_link_admin").html('<span id="title-success" class="help-block">'+pollData.message.link_valid+"</span>"),hideLabelMessage(".error_link_admin"))}function changeLinkUser(){var e=$(".hide").data("tokenUser");e!=$("#link_user").val()?$("#label_link_user").removeAttr("href"):$("#label_link_user").attr("href",$(".token-user").val()),(pollData.config.link+$("#link_user").val()).length>60?$("#label_link_user").html((pollData.config.link+$("#link_user").val()).substring(0,60)+"..."):$("#label_link_user").html(pollData.config.link+$("#link_user").val()),""==$("#link_user").val()?($("#link_user").addClass("has-error"),$(".error_link_user").addClass("has-error"),$(".error_link_user").html('<span id="title-error" class="help-block">'+pollData.message.required+"</span>")):validateLink($("#link_user").val()).responseJSON.success?($("#link_user").addClass("has-error"),$(".error_link_user").addClass("has-error"),$(".error_link_user").html('<span id="title-error" class="help-block">'+pollData.message.link_exists+"</span>"),hideLabelMessage(".error_link_user")):($("#link_user").removeClass("has-error"),$(".error_link_user").removeClass("has-error"),$(".error_link_user").html('<span id="title-success" class="help-block">'+pollData.message.link_valid+"</span>"),hideLabelMessage(".error_link_user"))}function checkOptionSame(e){var a=[],t=!1,l="string"==typeof e?e:pollData.message.option_duplicate;return $('input[name^="optionText"]').each(function(){var e=$(this).val().trim();a.indexOf(e)!==-1&&""!=e&&(t=!0),a.push(e)}),t?($(".error_option").addClass("has-error").html('<span id="title-error" class="help-block">'+l+"</span>"),$(".btn-edit-submit").length&&$(".btn-edit-submit").prop("disabled",!0)):($(".error_option").removeClass("has-error").html(""),$(".btn-edit-submit").length&&$(".btn-edit-submit").prop("disabled",!1)),t}function checkImageSame(){var e,a=[],t=!1,l=$(".poll-option img").get();return $.each(l,function(l,i){e=$("#"+$(i).attr("id")).attr("src"),"#"!=e&&""!=e&&($.inArray(e,a)<0?a.push(e):t=!0)}),t?$(".error_option").html('<span id="title-warning" class="help-block">'+pollData.message.option_image_duplicate+"</span>"):$(".error_option").html(""),t}function getCurrentLocation(){if(""==$("#location").val()){new google.maps.Map(document.getElementById("map"),{center:{lat:-34.397,lng:150.644},zoom:6});navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(e){$.ajax({url:$(".hide").data("locationRoute"),type:"post",data:{lat:e.coords.latitude,lng:e.coords.longitude,_token:$(".hide").data("token")},success:function(e){e.success&&""!=e.location&&$("#location").val(e.location)}})})}}function setDatePicker(e){e.datetimepicker({showClose:!0,icons:{close:"glyphicon glyphicon-ok"}})}function setObjectDatePicker(){var e=$(".datetimepicker").last();setDatePicker(e),e.data("tempDatePicker",e.data("DateTimePicker")),e.last().data("DateTimePicker").hide().destroy()}function pickDateOption(){$(".poll-option").on("click",".pick-date",function(){$(this).parent().data("tempDatePicker").show()}),$(".poll-option").on("dp.hide",".datetimepicker",function(){var e=$(this),a=e.find("input[type=text]"),t=a.val(),l="undefined"==typeof e.data("pickingDate")?"":e.data("pickingDate").trim(),i=(l+" "+t).trim();a.val(i)}),$(".poll-option").on("input","input[name^=optionText]",function(){var e=$(this).parent(),a=e.find("input[type=text]").val();e.data("pickingDate",a)})}var pollData=$(".hide").data("poll"),dataAction=$(".hide").data("page"),_validFileExtensions=[".jpg",".jpeg",".bmp",".gif",".png"],actionShowHides=["show","hide"],typeElement=["id","class"],rand=function(){return Math.random().toString(36).substr(2)},gliphyCalendarGroup='<span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>';$('a[data-toggle="tooltip"]').tooltip({animated:"fade",placement:"bottom",html:!0}),$(function(){$("#time_close_poll").datetimepicker({format:"DD-MM-YYYY HH:mm"})}),"undefined"!=typeof pollData&&jQuery.validator.addMethod("time",function(e,a){if(e){var t=$(".hide").data("linkCheckDate"),l=$("#time_close_poll").val(),i=$.ajax({type:"GET",url:t,dataType:"JSON",async:!1,data:{date_close_poll:l},success:function(e){return!!e.success}});return i.responseJSON.success}return!0},pollData.message.time_close_poll),$(window).scroll(function(){$(this).scrollTop()>100?$("#scroll").fadeIn():$("#scroll").fadeOut()}),$("#scroll").click(function(){return $("html, body").animate({scrollTop:0},600),!1}),$(".btn-show-advance-add-option").click(function(){$(".addAdvance").slideToggle("slow");var e=this.id;"show"==e?($(".btn-show-advance-add-option").html('<span class="glyphicon glyphicon-hand-right"></span>'),this.id="hide"):($(".btn-show-advance-add-option").html('<span class="glyphicon glyphicon-hand-left"></span>'),this.id="show")}),$(document).ready(function(){if($(".finish").click(function(){validateParticipant()&validateOption()&&!checkOptionSame()&&($("#form_create_poll, #form_duplicate_poll").submit(),$(".loader").show())}),"undefined"!=typeof pollData){$.each(pollData.config.setting,function(e,a){$("[name='setting\\["+a+"\\]']").bootstrapSwitch({onText:pollData.message.on,offText:pollData.message.off,size:"not_same_email"==e?"small":null})});var e=$("#form_create_poll, #form_update_poll_info, #form_duplicate_poll").validate({rules:{email:{required:!0,maxlength:pollData.config.length.email,email:!0},name:{required:!0,maxlength:pollData.config.length.name},title:{required:!0,maxlength:pollData.config.length.title},closingTime:{time:!0}},messages:{email:{required:pollData.message.required,maxlength:pollData.message.max+pollData.config.length.email,email:pollData.message.email},name:{required:pollData.message.required,maxlength:pollData.message.max+pollData.config.length.name},title:{required:pollData.message.required,maxlength:pollData.message.max+pollData.config.length.title},closingTime:{time:pollData.message.time_close_poll}},highlight:function(e){$(e).closest(".form-group").addClass("has-error")},unhighlight:function(e){$(e).closest(".form-group").removeClass("has-error")},errorElement:"span",errorClass:"help-block",errorPlacement:function(e,a){a.parent(".input-group").length?e.insertAfter(a.parent()):e.insertAfter(a)}});$("#create_poll_wizard").bootstrapWizard({tabClass:"nav nav-tabs",onNext:function(a,t,l){return checkValidFormWinzard($("#create_poll_wizard"),$("#form_create_poll"),e)},onTabClick:function(a,t,l){return checkValidFormWinzard($("#create_poll_wizard"),$("#form_create_poll"),e)},onTabShow:function(e,a,t){var l=a.find("li").length,i=t+1,o=i/l*100;$("#create_poll_wizard").find(".bar").css({width:o+"%"}),1==i?$("#create_poll_wizard").find(".pager .previous").hide():($("#create_poll_wizard").find(".pager .previous").show(),2==i&&($(".finish").removeClass("hidden"),$(".btn-finish").addClass("btn-center")),4==i&&$(".btn-finish").removeClass("btn-center"))}})}$("#voting_wizard").bootstrapWizard({}),$("#manager_poll_wizard").bootstrapWizard({}),$("#edit_poll_wizard").bootstrapWizard({}),$("#duplicate_poll_wizard").bootstrapWizard({tabClass:"nav nav-tabs",onNext:function(a,t,l){return checkValidFormWinzard($("#duplicate_poll_wizard"),$("#form_duplicate_poll"),e)},onTabClick:function(a,t,l){return checkValidFormWinzard($("#duplicate_poll_wizard"),$("#form_duplicate_poll"),e)},onTabShow:function(e,a,t){var l=a.find("li").length,i=t+1,o=i/l*100;$("#duplicate_poll_wizard").find(".bar").css({width:o+"%"}),1==i&&$("#create_poll_wizard").find(".pager .previous").hide()}}),$("input[name^=setting_child]").on("change",function(){var e=$(this).val(),a=pollData.config.setting;if(e==a.required_name)return void $(".setting-"+a.not_same_email).fadeOut();var t=$(this).parent().siblings(".setting-"+a.not_same_email);$(".setting-"+a.not_same_email).not(t).hide(),t.fadeIn().css("display","inline-block")})}),$(window).on("load",function(){if("undefined"!=typeof pollData){var e=pollData.oldInput,a=pollData.view.option,t=pollData.config.length.option;createOption(a,t,e),pickDateOption(),e&&$("#email-participant").show()}}),null!=document.getElementById("location")&&google.maps.event.addDomListener(window,"load",function(){var e=new google.maps.places.Autocomplete(document.getElementById("location"));google.maps.event.addListener(e,"place_changed",function(){})});